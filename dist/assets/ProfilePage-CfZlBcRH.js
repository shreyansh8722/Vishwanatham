import{j as e,y as S,h as k,z as C,B as I,D as E,E as U,F as L,J as A,K as R,N as T,A as $,m as q}from"./ui-vendor-DvYRwaTC.js";import{b as D,r as j}from"./react-vendor-BrYn47dg.js";import{f as O,d as f,z as v,b as F}from"./index-BaMFXKro.js";import{N as M,F as W}from"./Footer-BU4Q99GI.js";import{q as B,m as V,w as H,l as G,f as J,d as P,c as K,D as Q,E as X}from"./firebase-vendor-ChDbu2GB.js";function Y({userId:s}){const l=D(),[a,p]=j.useState([]),[n,c]=j.useState(!0);j.useEffect(()=>{if(!s){c(!1);return}const t=B(G(f,"orders"),H("userId","==",s),V("createdAt","desc")),r=J(t,m=>{const d=m.docs.map(o=>{var x;return{id:o.id,...o.data(),createdAt:(x=o.data().createdAt)!=null&&x.toDate?o.data().createdAt.toDate():new Date}});p(d),c(!1)});return()=>r()},[s]);const u=async t=>{if(window.confirm("Are you sure you want to cancel this order?"))try{const r=P(f,"orders",t),m=await K(r);if(!m.exists()){v.error("Order not found");return}const d=m.data(),o=Q(f);o.update(r,{status:"Cancelled",cancelledAt:new Date}),d.items&&Array.isArray(d.items)&&d.items.forEach(x=>{const N=P(f,"products",x.id);o.update(N,{stock:X(x.quantity)})}),await o.commit(),v.success("Order cancelled and stock restored")}catch(r){console.error(r),v.error("Failed to cancel. Please contact support.")}},g=t=>{const r=`Hi Pahnawa Team, I would like to exchange/return items from Order ID: ${t}`;window.open(`https://wa.me/919305491919?text=${encodeURIComponent(r)}`,"_blank")},b=t=>{const r=(t||"processing").toLowerCase();return r.includes("deliver")?{color:"text-emerald-600",bg:"bg-emerald-50",icon:E,label:"Delivered"}:r.includes("ship")||r.includes("dispatch")?{color:"text-blue-600",bg:"bg-blue-50",icon:k,label:"In Transit"}:r.includes("cancel")?{color:"text-red-600",bg:"bg-red-50",icon:C,label:"Cancelled"}:{color:"text-amber-600",bg:"bg-amber-50",icon:U,label:"Processing"}};return n?e.jsx("div",{className:"text-center py-20 text-xs uppercase tracking-widest text-stone-400",children:"Loading your collection..."}):a.length===0?e.jsxs("div",{className:"text-center py-20 border border-dashed border-stone-200 bg-stone-50/50",children:[e.jsx(S,{size:40,strokeWidth:1,className:"text-stone-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-serif text-stone-900 mb-2 italic",children:"No Orders Yet"}),e.jsx("button",{onClick:()=>l("/shop"),className:"mt-4 text-xs font-bold uppercase tracking-widest text-heritage-gold border-b border-heritage-gold pb-1 hover:text-heritage-charcoal hover:border-heritage-charcoal transition-all",children:"Explore Collection"})]}):e.jsx("div",{className:"space-y-8",children:a.map(t=>{var y;const{color:r,bg:m,icon:d,label:o}=b(t.status),x=["Processing","Pending"].includes(t.status||"Processing"),N=(t.status||"").toLowerCase().includes("delivered");return e.jsxs("div",{className:"group bg-white border border-stone-200 rounded-sm hover:border-heritage-gold/30 transition-all duration-500 overflow-hidden",children:[e.jsxs("div",{className:"px-6 py-4 bg-stone-50/50 border-b border-stone-100 flex flex-wrap gap-4 justify-between items-center",children:[e.jsxs("div",{className:"flex gap-6 text-xs text-stone-500",children:[e.jsxs("div",{children:[e.jsx("span",{className:"block uppercase tracking-widest text-[9px] text-stone-400 mb-1",children:"Order Placed"}),e.jsx("span",{className:"font-medium text-stone-900",children:t.createdAt.toLocaleDateString("en-IN",{day:"numeric",month:"long",year:"numeric"})})]}),e.jsxs("div",{children:[e.jsx("span",{className:"block uppercase tracking-widest text-[9px] text-stone-400 mb-1",children:"Total"}),e.jsxs("span",{className:"font-medium text-stone-900",children:["₹",O(t.totalAmount||t.total)]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"block uppercase tracking-widest text-[9px] text-stone-400 mb-1",children:"Order ID"}),e.jsxs("span",{className:"font-medium text-stone-900",children:["#",t.id.slice(-8).toUpperCase()]})]})]}),e.jsxs("div",{className:`flex items-center gap-2 px-3 py-1 rounded-full text-[10px] font-bold uppercase tracking-widest ${m} ${r}`,children:[e.jsx(d,{size:12})," ",o]})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"flex flex-col gap-6",children:(y=t.items)==null?void 0:y.map((i,z)=>e.jsxs("div",{className:"flex gap-6 items-start",children:[e.jsx("div",{className:"w-20 h-24 bg-stone-100 border border-stone-200 shrink-0",children:e.jsx("img",{src:i.featuredImageUrl||i.image||"/placeholder.jpg",alt:i.name,className:"w-full h-full object-cover mix-blend-multiply"})}),e.jsxs("div",{className:"flex-1 pt-1",children:[e.jsx("h4",{className:"font-serif text-lg text-heritage-charcoal leading-tight mb-2",children:e.jsx("span",{onClick:()=>l(`/product/${i.id}`),className:"cursor-pointer hover:text-heritage-gold transition-colors",children:i.name})}),e.jsxs("p",{className:"text-xs text-stone-500 font-sans mb-1",children:["Size: ",e.jsx("span",{className:"text-stone-800",children:i.selectedSize||"Standard"}),e.jsx("span",{className:"mx-2 text-stone-300",children:"|"}),"Qty: ",i.quantity]}),e.jsxs("p",{className:"text-sm font-medium text-heritage-charcoal",children:["₹",O(i.price)]})]})]},z))}),e.jsxs("div",{className:"mt-8 pt-6 border-t border-stone-100 flex flex-wrap gap-4 justify-end",children:[!o.includes("Cancelled")&&e.jsxs("button",{onClick:()=>l("/track-order",{state:{orderId:t.id}}),className:"flex items-center gap-2 px-5 py-2.5 border border-stone-200 text-stone-600 text-[10px] font-bold uppercase tracking-[0.15em] hover:bg-stone-50 hover:text-stone-900 transition-colors",children:[e.jsx(k,{size:14})," Track Order"]}),x&&e.jsxs("button",{onClick:()=>u(t.id),className:"flex items-center gap-2 px-5 py-2.5 border border-red-100 text-red-600 text-[10px] font-bold uppercase tracking-[0.15em] hover:bg-red-50 transition-colors",children:[e.jsx(C,{size:14})," Cancel Order"]}),N&&e.jsxs("button",{onClick:()=>g(t.id),className:"flex items-center gap-2 px-5 py-2.5 bg-stone-900 text-white text-[10px] font-bold uppercase tracking-[0.15em] hover:bg-heritage-gold border border-transparent transition-colors shadow-sm",children:[e.jsx(I,{size:14})," Exchange / Return"]}),e.jsx("button",{onClick:()=>g(t.id),className:"flex items-center gap-2 px-5 py-2.5 text-stone-400 hover:text-stone-600 text-[10px] font-bold uppercase tracking-[0.15em] transition-colors",children:"Need Help?"})]})]})]},t.id)})})}const h=({icon:s,label:l,active:a,onClick:p,danger:n})=>e.jsxs("button",{onClick:p,className:`
      w-full flex items-center gap-4 p-4 transition-all duration-300 group border-l-2
      ${a?"border-heritage-gold bg-stone-50 text-heritage-charcoal":"border-transparent text-stone-400 hover:text-stone-800 hover:bg-stone-50/50"}
      ${n&&"hover:text-red-600 hover:border-red-200"}
    `,children:[e.jsx(s,{size:18,strokeWidth:1.5,className:a?"text-heritage-gold":"group-hover:scale-105 transition-transform"}),e.jsx("span",{className:`text-xs uppercase tracking-[0.15em] font-medium ${a?"font-bold":""}`,children:l})]}),w=({children:s,title:l,subtitle:a})=>e.jsxs(q.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.4,ease:"easeOut"},className:"h-full",children:[e.jsxs("div",{className:"mb-10 border-b border-stone-100 pb-6",children:[e.jsx("h2",{className:"text-3xl font-serif text-heritage-charcoal italic mb-2",children:l}),a&&e.jsx("p",{className:"text-sm text-stone-400 font-light font-sans",children:a})]}),s]});function re(){var b,t;const{user:s,userRole:l,logout:a}=F(),p=D(),[n,c]=j.useState("orders"),u=l==="admin",g=async()=>{await a(),p("/")};return s?e.jsxs("div",{className:"min-h-screen bg-white font-sans text-heritage-charcoal selection:bg-heritage-gold selection:text-white",children:[e.jsx(M,{}),e.jsx("div",{className:"pt-32 pb-24 max-w-7xl mx-auto px-6 lg:px-12",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-16 lg:gap-24",children:[e.jsx("div",{className:"lg:w-64 shrink-0",children:e.jsxs("div",{className:"sticky top-32",children:[e.jsxs("div",{className:"mb-12 px-4",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-stone-100 flex items-center justify-center text-heritage-gold text-2xl font-serif mb-4",children:s.photoURL?e.jsx("img",{src:s.photoURL,alt:"Profile",className:"w-full h-full rounded-full object-cover"}):((t=(b=s.displayName)==null?void 0:b[0])==null?void 0:t.toUpperCase())||"U"}),e.jsx("h3",{className:"font-serif text-xl text-heritage-charcoal mb-1",children:s.displayName||"Guest User"}),u&&e.jsx("span",{className:"inline-block px-2 py-0.5 bg-red-100 text-red-600 text-[9px] font-bold uppercase tracking-widest rounded-sm mb-2",children:"Administrator"}),e.jsx("p",{className:"text-[10px] uppercase tracking-widest text-stone-400",children:s.email})]}),e.jsxs("nav",{className:"space-y-1",children:[u&&e.jsx(h,{icon:L,label:"Admin Dashboard",onClick:()=>p("/admin")}),e.jsx(h,{icon:S,label:"Orders",active:n==="orders",onClick:()=>c("orders")}),e.jsx(h,{icon:A,label:"Addresses",active:n==="addresses",onClick:()=>c("addresses")}),e.jsx(h,{icon:R,label:"Settings",active:n==="settings",onClick:()=>c("settings")}),e.jsx("div",{className:"pt-8 mt-8 border-t border-stone-100",children:e.jsx(h,{icon:T,label:"Sign Out",onClick:g,danger:!0})})]})]})}),e.jsx("div",{className:"flex-1 min-h-[600px]",children:e.jsxs($,{mode:"wait",children:[n==="orders"&&e.jsx(w,{title:"My Orders",subtitle:"Track, return, or exchange your purchases.",children:e.jsx(Y,{userId:s.uid})},"orders"),n==="addresses"&&e.jsx(w,{title:"Addresses",subtitle:"Manage your shipping destinations.",children:e.jsxs("div",{className:"p-12 border border-dashed border-stone-200 rounded-sm bg-stone-50/50 text-center flex flex-col items-center justify-center",children:[e.jsx(A,{size:32,className:"text-stone-300 mb-4",strokeWidth:1}),e.jsx("p",{className:"text-sm text-stone-500 mb-6 font-light max-w-sm",children:"We save your address automatically when you place your first order."}),e.jsx("button",{onClick:()=>c("orders"),className:"text-xs font-bold uppercase tracking-widest text-heritage-gold hover:text-heritage-charcoal transition-colors border-b border-heritage-gold pb-1",children:"View Orders"})]})},"addresses"),n==="settings"&&e.jsx(w,{title:"Settings",subtitle:"Update your personal information.",children:e.jsxs("form",{className:"max-w-lg space-y-10",children:[e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"group",children:[e.jsx("label",{className:"block text-[10px] font-bold uppercase tracking-widest text-stone-400 mb-3 group-focus-within:text-heritage-gold transition-colors",children:"Full Name"}),e.jsx("input",{type:"text",defaultValue:s.displayName,className:"w-full border-b border-stone-200 py-2 text-xl font-serif text-heritage-charcoal focus:border-heritage-gold outline-none bg-transparent transition-colors"})]}),e.jsxs("div",{className:"group",children:[e.jsx("label",{className:"block text-[10px] font-bold uppercase tracking-widest text-stone-400 mb-3",children:"Email"}),e.jsx("input",{type:"email",defaultValue:s.email,disabled:!0,className:"w-full border-b border-stone-200 py-2 text-stone-400 bg-transparent cursor-not-allowed font-sans"})]}),e.jsxs("div",{className:"group",children:[e.jsx("label",{className:"block text-[10px] font-bold uppercase tracking-widest text-stone-400 mb-3 group-focus-within:text-heritage-gold transition-colors",children:"Phone"}),e.jsx("input",{type:"tel",placeholder:"+91",className:"w-full border-b border-stone-200 py-2 text-xl font-serif text-heritage-charcoal focus:border-heritage-gold outline-none bg-transparent transition-colors"})]})]}),e.jsx("button",{className:"px-10 py-4 bg-heritage-charcoal text-white text-[10px] font-bold uppercase tracking-[0.2em] hover:bg-heritage-gold transition-all shadow-lg rounded-sm",children:"Update Profile"})]})},"settings")]})})]})}),e.jsx(W,{})]}):null}export{re as default};
