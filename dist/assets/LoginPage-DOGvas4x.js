import{j as e,r as C,v as P,a as A}from"./ui-vendor-DvYRwaTC.js";import{r as i,b as E,u as F}from"./react-vendor-BrYn47dg.js";import{C as I,h as L,j as G,G as R,k as W,d as B,c as D,e as M}from"./firebase-vendor-ChDbu2GB.js";import{b as z,c,d as J}from"./index-BaMFXKro.js";import{u as O,a as T,o as q,s as j}from"./schemas-IBkb4Gt7.js";import{N as H,F as K}from"./Footer-BU4Q99GI.js";const N=q({email:j().email({message:"Please enter a valid email address"}),password:j().min(6,{message:"Password must be at least 6 characters"})}),Q=N;function U(){const[s,d]=i.useState("login"),[x,l]=i.useState(null),[u,m]=i.useState(null),[g,o]=i.useState(!1),p=E(),h=F(),{user:f}=z(),{register:b,handleSubmit:v,formState:{errors:n},reset:y}=O({resolver:T(s==="login"?N:Q)});i.useEffect(()=>{y(),l(null),m(null)},[s,y]),i.useEffect(()=>{var t;if(f){const a=((t=h.state)==null?void 0:t.from)||"/profile";p(a,{replace:!0})}},[f,p,h]);const w=async t=>{const a=B(J,"users",t.uid);(await D(a)).exists()||await M(a,{uid:t.uid,email:t.email,displayName:t.displayName||"",favorites:[],cart:[],createdAt:new Date})},k=async t=>{o(!0),l(null),m(null);try{if(s==="forgot"){await I(c,t.email),m("We've sent a password reset link to your email."),o(!1);return}let a;s==="login"?a=await L(c,t.email,t.password):(a=await G(c,t.email,t.password),await w(a.user))}catch(a){let r=a.message.replace("Firebase: ","");r.includes("auth/invalid-credential")&&(r="Incorrect email or password."),r.includes("auth/email-already-in-use")&&(r="This email is already registered."),l(r)}finally{o(!1)}},S=async()=>{const t=new R;o(!0);try{const a=await W(c,t);await w(a.user)}catch(a){l(a.message)}finally{o(!1)}};return e.jsxs("div",{className:"min-h-screen bg-heritage-paper font-sans text-heritage-charcoal flex flex-col",children:[e.jsx(H,{}),e.jsx("div",{className:"flex-grow flex items-center justify-center py-20 px-4 relative",children:e.jsxs("div",{className:"w-full max-w-md",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("h1",{className:"font-serif text-4xl italic mb-3 text-heritage-charcoal",children:s==="forgot"?"Reset Password":s==="login"?"Welcome Back":"Join the Family"}),e.jsx("p",{className:"text-xs uppercase tracking-widest text-heritage-grey",children:s==="forgot"?"Enter your email to recover access":s==="login"?"Access your wishlist & orders":"Begin your journey with Banaras"})]}),x&&e.jsxs("div",{className:"flex items-center gap-3 text-red-800 text-xs font-medium bg-red-50 p-4 mb-8 border border-red-100",children:[e.jsx(C,{size:16})," ",x]}),u&&e.jsxs("div",{className:"flex items-center gap-3 text-green-800 text-xs font-medium bg-green-50 p-4 mb-8 border border-green-100",children:[e.jsx(P,{size:16})," ",u]}),e.jsxs("form",{onSubmit:v(k),className:"space-y-8",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"text-[10px] uppercase tracking-widest font-bold text-heritage-grey",children:"Email Address"}),e.jsx("input",{...b("email"),type:"email",className:"w-full border-b border-gray-300 py-3 bg-transparent text-sm focus:border-heritage-gold outline-none transition-colors placeholder:text-gray-300",placeholder:"name@example.com"}),n.email&&e.jsx("p",{className:"text-red-500 text-[10px] pt-1",children:n.email.message})]}),s!=="forgot"&&e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between items-baseline",children:[e.jsx("label",{className:"text-[10px] uppercase tracking-widest font-bold text-heritage-grey",children:"Password"}),s==="login"&&e.jsx("button",{type:"button",onClick:()=>d("forgot"),className:"text-[10px] text-heritage-grey hover:text-heritage-gold transition-colors",children:"Forgot?"})]}),e.jsx("input",{...b("password"),type:"password",className:"w-full border-b border-gray-300 py-3 bg-transparent text-sm focus:border-heritage-gold outline-none transition-colors placeholder:text-gray-300",placeholder:"••••••••"}),n.password&&e.jsx("p",{className:"text-red-500 text-[10px] pt-1",children:n.password.message})]}),e.jsxs("button",{type:"submit",disabled:g,className:"w-full bg-heritage-charcoal text-white py-4 text-xs font-bold uppercase tracking-[0.2em] hover:bg-heritage-gold transition-all duration-300 flex justify-center items-center gap-2 mt-8 disabled:opacity-70",children:[g&&e.jsx(A,{className:"animate-spin w-4 h-4"}),s==="forgot"?"Send Link":s==="login"?"Sign In":"Create Account"]})]}),s!=="forgot"&&e.jsxs("div",{className:"mt-8 space-y-6",children:[e.jsxs("div",{className:"relative flex py-2 items-center",children:[e.jsx("div",{className:"flex-grow border-t border-gray-100"}),e.jsx("span",{className:"flex-shrink-0 mx-4 text-[10px] uppercase tracking-widest text-gray-300",children:"Or"}),e.jsx("div",{className:"flex-grow border-t border-gray-100"})]}),e.jsxs("button",{onClick:S,disabled:g,className:"w-full border border-gray-200 text-heritage-charcoal py-3 text-xs uppercase tracking-widest font-bold hover:border-heritage-charcoal transition-colors flex items-center justify-center gap-3",children:[e.jsx("span",{className:"font-serif italic text-lg",children:"G"})," Continue with Google"]})]}),e.jsx("div",{className:"text-center mt-10",children:s==="forgot"?e.jsx("button",{onClick:()=>d("login"),className:"text-xs uppercase tracking-widest border-b border-heritage-gold pb-0.5 hover:text-heritage-gold transition-colors",children:"Return to Login"}):e.jsxs("p",{className:"text-xs text-heritage-grey",children:[s==="login"?"New to Pahnawa? ":"Already a member? ",e.jsx("button",{onClick:()=>d(s==="login"?"signup":"login"),className:"underline underline-offset-4 decoration-heritage-gold hover:text-heritage-gold transition-colors font-medium ml-1",children:s==="login"?"Create an Account":"Sign In"})]})})]})}),e.jsx(K,{})]})}export{U as default};
